{% extends "base.html" %}

{% block title %}{{ tournament.name }} - Pickleball Tournament Platform{% endblock %}

{% block content %}
<!-- Tournament Banner -->
<div class="relative w-full h-64 rounded-lg overflow-hidden mb-8">
    {% if tournament.banner %}
        <img src="{{ url_for('static', filename=tournament.banner) }}" alt="{{ tournament.name }}" class="w-full h-full object-cover">
    {% else %}
        <div class="w-full h-full bg-gradient-to-r from-blue-600 to-indigo-700 flex items-center justify-center">
            <span class="text-white text-3xl font-bold">{{ tournament.name }}</span>
        </div>
    {% endif %}
    <div class="absolute inset-0 bg-gradient-to-r from-blue-900/70 to-transparent flex items-center">
        <div class="px-8">
            <h1 class="text-4xl font-bold text-white">{{ tournament.name }}</h1>
            <p class="text-xl text-white mt-2">{{ tournament.start_date.strftime('%B %-d') }}-{{ tournament.end_date.strftime('%-d, %Y') }}</p>
        </div>
    </div>
    <div class="absolute top-4 right-4">
        <div class="badge-{{ tournament.tier.value }} px-3 py-1 rounded-full text-sm font-medium inline-flex items-center">
            {{ tournament.tier.value }}
        </div>
    </div>
</div>

<!-- Tournament Details -->
<div class="grid grid-cols-1 md:grid-cols-3 gap-8 mb-8">
    <!-- Tournament Info -->
    <div class="md:col-span-2">
        <div class="bg-white p-6 rounded-lg shadow-sm">
            <h2 class="text-2xl font-bold mb-4">About This Tournament</h2>
            <div class="space-y-4">
                <div>
                    <h3 class="text-gray-600 font-medium">Location</h3>
                    <p class="text-gray-900">{{ tournament.location }}</p>
                </div>
                <div>
                    <h3 class="text-gray-600 font-medium">Dates</h3>
                    <p class="text-gray-900">{{ tournament.start_date.strftime('%B %-d') }}-{{ tournament.end_date.strftime('%-d, %Y') }}</p>
                </div>
                <div>
                    <h3 class="text-gray-600 font-medium">Registration Deadline</h3>
                    <p class="text-gray-900">{{ tournament.registration_deadline.strftime('%B %-d, %Y') }}</p>
                </div>
                <div>
                    <h3 class="text-gray-600 font-medium">Format</h3>
                    <p class="text-gray-900">{{ tournament.format.value }}</p>
                </div>
                <div>
                    <h3 class="text-gray-600 font-medium">Prize Pool</h3>
                    <p class="text-gray-900">${{ tournament.prize_pool|int }}</p>
                </div>
                <div>
                    <h3 class="text-gray-600 font-medium">Description</h3>
                    <div class="text-gray-900">{{ tournament.description|nl2br }}</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Categories and Actions -->
    <div>
        <div class="bg-white p-6 rounded-lg shadow-sm mb-6">
            <h2 class="text-2xl font-bold mb-4">Categories</h2>
            <div class="space-y-3">
                {% for category in categories %}
                    <div class="flex justify-between items-center py-2 border-b border-gray-100">
                        <span class="font-medium">{{ category.category_type.value }}</span>
                        <span class="text-blue-600 font-medium">{{ category.points_awarded }} pts</span>
                    </div>
                {% else %}
                    <p class="text-gray-600">No categories available.</p>
                {% endfor %}
            </div>
        </div>

        <div class="bg-white p-6 rounded-lg shadow-sm">
            <h2 class="text-2xl font-bold mb-4">Actions</h2>
            {% if tournament.status.value == 'upcoming' %}
                {% if tournament.is_registration_open() %}
                    {% if current_user.is_authenticated and current_user.is_player() %}
                        <a href="{{ url_for('player.register_tournament', tournament_id=tournament.id) }}" class="w-full block text-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition mb-4">
                            Register Now
                        </a>
                    {% else %}
                        <a href="{{ url_for('auth.login') }}" class="w-full block text-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition mb-4">
                            Sign In to Register
                        </a>
                    {% endif %}
                {% else %}
                    <div class="w-full block text-center px-4 py-2 bg-gray-300 text-gray-600 rounded-lg mb-4">
                        Registration Closed
                    </div>
                {% endif %}
            {% endif %}

            <div class="space-y-2">
                <a href="{{ url_for('tournament.participants', id=tournament.id) }}" class="w-full block text-center px-4 py-2 bg-white border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition">
                    View Participants
                </a>
                
                {% if tournament.status.value in ['ongoing', 'completed'] %}
                    <a href="{{ url_for('tournament.bracket', id=tournament.id) }}" class="w-full block text-center px-4 py-2 bg-white border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition">
                        View Brackets
                    </a>
                    
                    {% if tournament.status.value == 'ongoing' %}
                        <a href="{{ url_for('tournament.live_scoring', id=tournament.id) }}" class="w-full block text-center px-4 py-2 bg-white border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition">
                            Live Scoring
                        </a>
                    {% endif %}
                    
                    {% if tournament.status.value == 'completed' %}
                        <a href="{{ url_for('tournament.results', id=tournament.id) }}" class="w-full block text-center px-4 py-2 bg-white border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition">
                            View Results
                        </a>
                    {% endif %}
                {% endif %}
            </div>
        </div>
    </div>
</div>
{% endblock %}
